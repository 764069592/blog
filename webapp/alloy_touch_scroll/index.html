<!DOCTYPE html>
<html lang="zh-cn">

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="renderer" content="webkit">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="screen-orientation" content="portrait">
		<meta name="format-detection" content="telephone=no">
		<meta name="format-detection" content="email=no">
		<meta name="msapplication-tap-highlight" content="no">
		<meta http-equiv="Cache-Control" content="no-siteapp" />
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="screen-orientation" content="portrait">
		<meta name="x5-orientation" content="portrait">
		<meta name="full-screen" content="yes">
		<meta name="keywords" content="" />
		<meta name="description" content="" />
		<title>便民信息</title>
		<link rel="stylesheet" href="./css/style.css">
	</head>

	<body>
		<div class="convenience-list-body">
			<div class="header">
				<a href="javascript:history.go(-1);" class="back-arrows-icon"></a>
				<h1>便民信息</h1>
				<a href="#" class="person-avater-icon"></a>
			</div>
			<div id="wrapper">
				<div id="scroller">
					<div class="search-box">
						<i class="search-box-icon"></i>
						<input type="text" class="search-input" placeholder="搜索常用联系方式">
						<div class="search-opacity-bg"></div>
					</div>

					<div class="convenience-container">
						<div class="convenience-btn-list">
							<ul class="clearfix">
								<li class="border">屯溪</li>
								<li class="border">休宁</li>
								<li class="border">周边</li>
							</ul>
						</div>
						<ul class="convenience-list border-top" id="infoList">
							<li class="border-top">
								<h3>高新青年(大学生创业园)</h3>
								<div class="convenience-phone">
									<span>电话：0551-6854787</span>
									<span><a class="phone-icon" href="tel:10086"></a></span>
								</div>
								<span>地址：高新区科学大道119号产业园简介 地址：高新区科学大道119号产业园简介 </span>
							</li>
							<li class="border-top">
								<h3>高新青年(大学生创业园)</h3>
								<div class="convenience-phone">
									<span>电话：0551-6854787</span>
									<span><a class="phone-icon" href="tel:10086"></a></span>
								</div>
								<span>地址：高新区科学大道119号产业园简介 地址：高新区科学大道119号产业园简介 </span>
							</li>
							<li class="border-top">
								<h3>高新青年(大学生创业园)</h3>
								<div class="convenience-phone">
									<span>电话：0551-6854787</span>
									<span><a class="phone-icon" href="tel:10086"></a></span>
								</div>
								<span>地址：高新区科学大道119号产业园简介 地址：高新区科学大道119号产业园简介 </span>
							</li>
							<li class="border-top">
								<h3>高新青年(大学生创业园)</h3>
								<div class="convenience-phone">
									<span>电话：0551-6854787</span>
									<span><a class="phone-icon" href="tel:10086"></a></span>
								</div>
								<span>地址：高新区科学大道119号产业园简介 地址：高新区科学大道119号产业园简介 </span>
							</li>
						</ul>
						<div id="pullUp">
							<div class="pullUpIcon">

							</div>
							<div class="pullUpLabel">下拉加载更多</div>
						</div>
					</div>

				</div>
			</div>
			<i class="go-top"></i>

		</div>
		<script src="./js/zepto.min.js"></script>
		<script src="./js/transform.js"></script>
		<script src="./js/alloy_touch.css.js"></script>
		<script>
			var start = 10;
			var updateFn = function() {
				var el = $('#infoList');
				var data = {
					start: start,
					type: 'music',
					count: 10,
					loc: 'beijing'
				};
				var url = "https://api.douban.com/v2/event/list";
				var count = 10;
				$.ajax({
					type: "post",
					data: data,
					dataType: 'jsonp',
					url: url,
					async: true,
					success: function(data) {
						if(data.events.length == 0) {
							return false;
						}
						var str = '';
						for(var i = 0, len = data.events.length; i < len; i++) {
							str += '<li class="border-top"><h3>' + data.events[i].title + '</h3><div class="convenience-phone"><span>电话：' + data.events[i].loc_id + '</span><span><a class="phone-icon" href="tel:' + data.events[i].loc_id + '"></a></span></div><span>地址：' + data.events[i].address + '</span></li>';
						}
						el.append($(str));
						start += count;
					}
				});
			};
			var scrollFn = function(obj) {
				var id = obj.id || '#wrapper';
				scrollerId = obj.scrollerId || '#scroller',
					scroller = document.querySelector(scrollerId),
					loading = false,
					Transform(scroller, true);
				var alloyTouch = new AlloyTouch({
					touch: id,
					vertical: true,
					target: scroller,
					property: "translateY",
					maxSpeed: 2,
					outFactor: 0.2,
					min: 160 * -20 + window.innerHeight - 202 - 50,
					max: 0,
					touchStart: function() {
						reastMin();
					},
					lockDirection: false,
					change: function(v) {
						if(v <= this.min + 5 && !loading) {
							loading = true;
							loadMore();
						}
					}
				})

				function loadMore() {
					setTimeout(function() {
						if(typeof obj.updateFn === 'function') {
							obj.updateFn();
						}
						loading = false;
						reastMin();
					}, 500)
				}

				function reastMin() {
					alloyTouch.min = -1 * parseInt(getComputedStyle(scroller).height) + window.innerHeight - 202;
				}

				document.addEventListener("touchmove", function(evt) {
					evt.preventDefault();
				}, false);
			};

			scrollFn({
				id: "#wrapper",
				scrollerId: "#scroller",
				updateFn: updateFn
			});
		</script>
	</body>

</html>
